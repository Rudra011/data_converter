<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <title>CSV to Campaigns Converter</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="privacy-banner">
        <svg class="privacy-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
            <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
        </svg>
        <span>Your data never leaves your browser. 100% client-side processing.</span>
    </div>

    <div class="container">
        <header>
            <div class="header-content">
                <div>
                    <h1>CSV to Campaigns Converter</h1>
                    <p class="subtitle">Transform your CSV data into campaign-ready format</p>
                </div>
                <button class="dark-mode-toggle" id="darkModeToggle" title="Toggle dark mode">
                    <svg class="sun-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                    <svg class="moon-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                </button>
            </div>
        </header>

        <section class="file-input-section">
            <div class="drop-zone" id="dropZone">
                <svg class="upload-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                    <polyline points="17 8 12 3 7 8"></polyline>
                    <line x1="12" y1="3" x2="12" y2="15"></line>
                </svg>
                <p class="drop-text">Drag & drop your CSV file here</p>
                <p class="drop-text-or">or</p>
                <button class="btn-browse" id="browseBtn">Browse Files</button>
                <input type="file" id="fileInput" accept=".csv" hidden>
            </div>
            <div class="file-info" id="fileInfo" style="display: none;">
                <span class="file-name" id="fileName"></span>
                <button class="btn-clear" id="clearFile">Clear</button>
            </div>

            <div class="progress-bar-container" id="progressBarContainer" style="display: none;">
                <div class="progress-info">
                    <span class="progress-label" id="progressLabel">Processing...</span>
                    <span class="progress-percentage" id="progressPercentage">0%</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
            </div>
        </section>

        <section class="options-section" id="optionsSection" style="display: none;">
            <div class="options-header-bar">
                <h2>Options</h2>
                <div class="options-controls">
                    <button class="btn-undo" id="undoBtn" title="Undo last change" disabled>
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M3 7v6h6"></path>
                            <path d="M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13"></path>
                        </svg>
                        Undo
                    </button>
                    <button class="btn-reset" id="resetBtn" title="Reset all options and mappings">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M1 4v6h6"></path>
                            <path d="M23 20v-6h-6"></path>
                            <path d="M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"></path>
                        </svg>
                        Reset All
                    </button>
                </div>
            </div>

            <div class="profile-selector-wrapper">
                <label for="outputProfile">Output Format:</label>
                <select id="outputProfile" class="profile-select">
                    <option value="zoho_campaigns">Zoho Campaigns</option>
                    <option value="zoho_crm">Zoho CRM (Leads)</option>
                    <option value="zoho_crm_contacts">Zoho CRM (Contacts)</option>
                    <option value="master_data">Master Data (Complete)</option>
                    <option value="simple">Simple (Name, Email, Phone)</option>
                    <option value="meta_ads">Meta/Facebook Ads Customer List</option>
                </select>
                <span class="profile-field-count" id="profileFieldCount">20 fields</span>
            </div>

            <h3 class="options-subtitle">General Settings</h3>
            <div class="options-grid">
                <div class="option-group">
                    <label for="globalTags">Global Tags (comma separated)</label>
                    <input type="text" id="globalTags" placeholder="e.g., Campaign2024, Newsletter">
                </div>
                <div class="option-group">
                    <label for="sourceField">Source</label>
                    <input type="text" id="sourceField" placeholder="Auto-filled from filename">
                </div>
                <div class="option-group checkbox-group">
                    <input type="checkbox" id="includeExtra">
                    <label for="includeExtra">Include unmapped input columns</label>
                </div>
            </div>

            <h3 class="options-subtitle">Data Intelligence</h3>
            <div class="options-grid">
                <div class="option-group checkbox-group">
                    <input type="checkbox" id="autoInferCompany" checked>
                    <label for="autoInferCompany">Auto-infer company from email domain</label>
                </div>
                <div class="option-group checkbox-group">
                    <input type="checkbox" id="autoInferTitle" checked>
                    <label for="autoInferTitle">Auto-infer job title from email</label>
                </div>
                <div class="option-group checkbox-group">
                    <input type="checkbox" id="classifyContacts" checked>
                    <label for="classifyContacts">Classify as Business/Individual</label>
                </div>
                <div class="option-group">
                    <label>Handle Duplicates:</label>
                    <div class="radio-group">
                        <label class="radio-label">
                            <input type="radio" name="duplicateHandling" value="keep" checked>
                            <span>Keep all</span>
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="duplicateHandling" value="skip">
                            <span>Skip duplicates</span>
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="duplicateHandling" value="mark">
                            <span>Mark with tag</span>
                        </label>
                    </div>
                    <span class="duplicate-count" id="duplicateCount"></span>
                </div>
            </div>
        </section>

        <section class="preview-section" id="previewSection" style="display: none;">
            <div class="preview-header-bar">
                <h2>Data Preview</h2>
                <div class="preview-info">
                    <span class="preview-row-count" id="previewRowCount">0 rows</span>
                    <span class="preview-toggle">
                        <label class="toggle-label">View:</label>
                        <select id="previewViewMode" class="preview-mode-select">
                            <option value="transformed">Transformed Output</option>
                            <option value="raw">Raw Input</option>
                        </select>
                    </span>
                </div>
            </div>

            <div class="preview-container" id="previewContainer">
                <div class="preview-table-wrapper">
                    <div class="preview-header-scroll" id="previewHeaderScroll">
                        <table class="preview-table" id="previewHeaderTable">
                            <thead class="preview-thead" id="previewTableHead">
                            </thead>
                        </table>
                    </div>
                    <div class="preview-scroll-container" id="previewScrollContainer">
                        <div class="preview-spacer-top" id="previewSpacerTop"></div>
                        <table class="preview-table" id="previewBodyTable">
                            <tbody class="preview-tbody" id="previewTableBody">
                            </tbody>
                        </table>
                        <div class="preview-spacer-bottom" id="previewSpacerBottom"></div>
                    </div>
                </div>
            </div>
        </section>

        <section class="mapping-section" id="mappingSection" style="display: none;">
            <div class="mapping-header-bar">
                <h2>Field Mapping</h2>
                <div class="preset-controls">
                    <select id="presetSelect" class="preset-select">
                        <option value="">-- Load Preset --</option>
                    </select>
                    <button class="btn-preset-save" id="savePresetBtn" title="Save current mapping as preset">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
                            <polyline points="17 21 17 13 7 13 7 21"></polyline>
                            <polyline points="7 3 7 8 15 8"></polyline>
                        </svg>
                        Save Preset
                    </button>
                </div>
            </div>
            <div class="mapping-container">
                <div class="mapping-header">
                    <div class="mapping-col-output">Output Field</div>
                    <div class="mapping-col-input">Map to Input Column</div>
                </div>
                <div class="mapping-body" id="mappingBody"></div>
            </div>
        </section>

        <section class="export-section" id="exportSection" style="display: none;">
            <h2>Export</h2>
            <div class="export-format-selector">
                <label for="exportFormat">Export Format:</label>
                <select id="exportFormat" class="format-select">
                    <option value="csv">CSV</option>
                    <option value="xlsx">XLSX (Excel)</option>
                    <option value="json">JSON</option>
                </select>
            </div>
            <div class="export-actions">
                <button class="btn-primary" id="downloadNew">Download New File</button>
                <div class="append-group" id="appendGroup">
                    <button class="btn-secondary" id="appendExisting">Append to Existing CSV</button>
                    <input type="file" id="existingFile" accept=".csv" hidden>
                </div>
            </div>
        </section>
    </div>

    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    <script src="script.js"></script>
</body>
</html>
